{"meta":{"title":"XGo","subtitle":null,"description":null,"author":"XGo","url":"http://blog.xgo.pub"},"pages":[{"title":"","date":"2017-05-12T16:00:37.037Z","updated":"2017-05-12T16:00:37.037Z","comments":true,"path":"REDEME.html","permalink":"http://blog.xgo.pub/REDEME.html","excerpt":"","text":"gaoxiang104.github.io"},{"title":"categories","date":"2017-05-12T02:39:51.000Z","updated":"2017-05-12T16:00:37.037Z","comments":false,"path":"categories/index.html","permalink":"http://blog.xgo.pub/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2017-05-12T02:37:24.000Z","updated":"2017-05-12T16:00:37.037Z","comments":false,"path":"tags/index.html","permalink":"http://blog.xgo.pub/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"nginx学习(3)——配置文件管理","slug":"nginx-3-configurationFile","date":"2017-05-20T14:45:47.000Z","updated":"2017-05-20T16:41:55.000Z","comments":true,"path":"2017/05/20/nginx-3-configurationFile/","link":"","permalink":"http://blog.xgo.pub/2017/05/20/nginx-3-configurationFile/","excerpt":"","text":"1. 配置文件在哪？ NGINX Plus is similar to other services in that it has a text-based configuration file written in a particular format. By default the file is named nginx.conf and placed in the /etc/nginx directory. NGINX Plus与其他服务类似，因为它具有以特定格式编写的基于文本的配置文件。默认情况下，文件名为nginx.conf并放在/etc/nginx目录中。(对于开源NGINX产品，所述位置取决于用于安装NGINX和操作系统程序包的系统。我的系统是ubuntu，nginx.conf所在目录是：/etc/nginx) 2. 配置文件结构 The configuration file consists of directives and their parameters. Simple (single-line) directives each end with a semicolon. Other directives act as “containers” that group together related directives, enclosing them in curly braces ( {} ). Here are some examples of simple directives. 配置文件由指令及其参数组成。简单（单行）指令各自以分号(;)结尾。其他指令作为“容器”，将相关指令组合在一起，将其包围在花括号（ {} ）中。以下是简单指令的一些示例。 123user nobody;error_log logs/error.log notice;worker_processes 1; 3. 引用子配置文件为了使配置更易于维护，可以将一组特定功能的配置文件存储在/etc/nginx/conf.d目录中，并使用include指令将引入nginx.conf文件中。123include conf.d/http;include conf.d/stream;include conf.d/exchange-enhanced; 4. traffic配置 A few top-level directives, referred to as contexts, group together the directives that apply to different traffic types: 一些顶级指令，称为上下文，将适用于不同traffic类型的指令组合在一起： events – General connection processing http – HTTP traffic mail – Mail traffic stream – TCP traffic In each of the traffic-handling contexts, you include one or more server contexts to define virtual servers that control the processing of requests. The directives you can include within a server context vary depending on the traffic type. 在每一个traffic-handling上下文中，包括一个或多个server上下文来定义控制和处理虚拟服务的请求。根据不同的traffic在server上下文中设置相应指令。 For HTTP traffic (the http context), each server directive controls the processing of requests for resources at particular domains or IP addresses. One or more location contexts in a server context define how to process specific sets of URIs. 对于HTTP流量（http上下文），每个server指令控制对特定域名或IP地址上的资源请求的处理。location上下文中的一个或多个上下文server定义了如何处理特定的URI集合。 For mail and TCP traffic (the mail and stream contexts) the server directives each control the processing of traffic arriving at a particular TCP port or UNIX socket. 对于邮件和TCP流量（mail和stream上下文），server伪指令各自控制到达特定TCP端口或UNIX套接字的流量处理。 以下配置说明了上下文的使用。12345678910111213141516171819202122232425262728293031323334user nobody; # a directive in the &apos;main&apos; contextevents &#123; # configuration of connection processing&#125;http &#123; # Configuration specific to HTTP and affecting all virtual servers server &#123; # configuration of HTTP virtual server 1 location /one &#123; # configuration for processing URIs with &apos;/one&apos; &#125; location /two &#123; # configuration for processing URIs with &apos;/two&apos; &#125; &#125; server &#123; # configuration of HTTP virtual server 2 &#125;&#125;stream &#123; # Configuration specific to TCP and affecting all virtual servers server &#123; # configuration of TCP virtual server 1 &#125;&#125; For most directives, a context that is defined inside another context (a child context) inherits the values of directives included at the parent level. To override a value inherited from the parent, include the directive in the child context. For more information on context inheritence, see the documentation for the proxy_set_header directive. 对于大多数指令，在另一个上下文（子上下文）中定义的上下文将继承父级中包含的伪指令的值。要覆盖从父进程继承的值，请在子上下文中包含该指令。有关上下文遗留的更多信息，请参阅指令的proxy_set_header文档。 5. 生效修改的配置要使更改修改过后的配置文件生效，Nginx必须重新加载文件。方式有两种： reload方式（推荐使用） 使用reload signal来生效修改后的配置，而不会中断当前请求的处理。 1# nginx -s reload 重启Nginx 步骤： 关闭Nginx 1# nginx -s stop 启动Nginx 1# nginx -c /etc/nginx/nginx.conf 6. 参考文献CREATING NGINX PLUS CONFIGURATION FILES","categories":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/categories/nginx/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/tags/nginx/"}]},{"title":"nginx学习(2)——进程和运行时控制","slug":"nginx-2-beginnerGuide","date":"2017-05-13T05:38:57.000Z","updated":"2017-05-14T16:13:08.504Z","comments":true,"path":"2017/05/13/nginx-2-beginnerGuide/","link":"","permalink":"http://blog.xgo.pub/2017/05/13/nginx-2-beginnerGuide/","excerpt":"","text":"1. 主进程和工作进程（Master and Worker Processes） NGINX has one master process and one or more worker processes. If caching is enabled, the cache loader and cache manager processes also run at startup. NGINX有一个主进程和一个或多个工作进程。如果启用缓存，缓存加载程序和缓存管理器进程也将在启动时运行。 The main purpose of the master process is to read and evaluate configuration files, as well as maintain the worker processes. 主程序的主要目的是读取和评估配置文件以及维护工作进程。 The worker processes do the actual processing of requests. NGINX relies on OS-dependent mechanisms to efficiently distribute requests among worker processes. The number of worker processes is defined in the nginx.conf configuration file and can be fixed for a given configuration or automatically adjusted to the number of available CPU cores (see worker_processes). 工作进程处理真实的请求。NGINX依赖于依赖于操作系统的机制来有效地在工作进程之间分配请求。工作进程的数量在nginx.conf配置文件中定义，并且可以针对给定的配置进行修复，或者自动调整为可用CPU内核的数量（参见 worker_processes）。 2. nginx控制首先查看nginx命令的help123456789101112131415# nginx -h nginx version: nginx/1.12.0Usage: nginx [-?hvVtTq] [-s signal] [-c filename] [-p prefix] [-g directives]Options: -?,-h : this help -v : show version and exit -V : show version and configure options then exit -t : test configuration and exit -T : test configuration, dump it and exit -q : suppress non-error messages during configuration testing -s signal : send signal to a master process: stop, quit, reopen, reload -p prefix : set prefix path (default: /etc/nginx/) -c filename : set configuration file (default: /etc/nginx/nginx.conf) -g directives : set global directives out of configuration file 2.1. 启动nginx启动方式如下：1# nginx -c /etc/nginx/nginx.conf 备注：网上找的启动方式，看help并不明白 nginx -c 就是start 2.2. nginx -s通过nginx -s signal来控制主进程，下面是signal的详细解释： stop : 快速关闭服务 quit : 正常关闭服务,该命令应该在启动nginx的同一用户下执行。 reload : 重新加载配置文件 reopen : 重新打开日志文件 Changes made in the configuration file will not be applied until the command to reload configuration is sent to nginx or it is restarted. To reload configuration, execute: nginx重启之前，配置文件中修改的内容将不会被应用，如果需要重新加载配置文件，需要执行：1nginx -s reload Once the master process receives the signal to reload configuration, it checks the syntax validity of the new configuration file and tries to apply the configuration provided in it. If this is a success, the master process starts new worker processes and sends messages to old worker processes, requesting them to shut down. Otherwise, the master process rolls back the changes and continues to work with the old configuration. Old worker processes, receiving a command to shut down, stop accepting new connections and continue to service current requests until all such requests are serviced. After that, the old worker processes exit. 一旦主进程收到要重新加载配置的命令，它将检查新配置文件的语法有效性，并尝试应用其中提供的配置。如果这是成功的，主进程将启动新的工作进程，并向旧的工作进程发送消息，请求它们关闭。否则，主进程回滚更改，并继续使用旧配置。老工作进程，接收关闭命令，停止接受新连接，并继续维护当前请求，直到所有这些请求得到维护。之后，旧的工作进程退出。 2.3. 查看nginx进程列表获取正在运行的nginx进程列表，可以使用下面的命令：1234# ps -ax | grep nginx 9345 ? Ss 0:00 nginx: master process nginx -c /etc/nginx/nginx.conf 9358 ? S 0:00 nginx: worker process11734 pts/18 S+ 0:00 grep --color=auto nginx 可以使用kill nginx master process正常关闭nginx :1keill -s QUIT 9345 3. 配置文件结构介绍 The way nginx and its modules work is determined in the configuration file. By default, the configuration file is named nginx.conf and placed in the directory /usr/local/nginx/conf, /etc/nginx, or /usr/local/etc/nginx. 配置文件中确定nginx及其模块的工作方式。默认的配置文件是 /etc/nginx/ 目录中的 nginx.conf 文件。 4. 参考文献 nginx documentation：Beginner’s GuideRuntime control :","categories":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/categories/nginx/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/tags/nginx/"}]},{"title":"nginx学习(1)——安装","slug":"nginx-1-install","date":"2017-05-12T08:14:25.000Z","updated":"2017-05-13T16:10:47.699Z","comments":true,"path":"2017/05/12/nginx-1-install/","link":"","permalink":"http://blog.xgo.pub/2017/05/12/nginx-1-install/","excerpt":"","text":"1. 安装计划 系统：ubuntu 16.04 LTS X86_64 安装nginx版本：nginx-1.12.0 Stable version 安装方式：使用apt安装 2. 安装2.1. 查找Ubuntu发行版的codename Version Codename Supported Platforms 12.04 precise x86_64, i386 14.04 trusty x86_64, i386, aarch64/arm64 16.04 xenial x86_64, i386, ppc64el, aarch64/arm64 16.10 yakkety x86_64, i386 2.2. 添加apt sources将以下内容追加到文件/etc/apt/sources.list末尾：12deb http://nginx.org/packages/ubuntu/ xenial nginxdeb-src http://nginx.org/packages/ubuntu/ xenial nginx 2.3. 下载并导入nginx signing keyRPM软件包和Debian / Ubuntu存储库都使用数字签名来验证下载包的完整性和起源。为了检查签名，需要下载 nginx签名密钥 并将其导入rpm或apt 程序的密钥环：1sudo apt-key add /%密钥所在文件夹%/nginx_signing.key 2.4. 执行安装12sudo apt-get updatesudo apt-get install nginx 2.5. 安装完成123456789101112131415$ nginx -hnginx version: nginx/1.12.0Usage: nginx [-?hvVtTq] [-s signal] [-c filename] [-p prefix] [-g directives]Options: -?,-h : this help -v : show version and exit -V : show version and configure options then exit -t : test configuration and exit -T : test configuration, dump it and exit -q : suppress non-error messages during configuration testing -s signal : send signal to a master process: stop, quit, reopen, reload -p prefix : set prefix path (default: /etc/nginx/) -c filename : set configuration file (default: /etc/nginx/nginx.conf) -g directives : set global directives out of configuration file 3. 参考文档 nginx documentation：Installing nginx","categories":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/categories/nginx/"}],"tags":[{"name":"nginx","slug":"nginx","permalink":"http://blog.xgo.pub/tags/nginx/"}]},{"title":"Hello World","slug":"hello-world","date":"2017-05-11T08:14:25.000Z","updated":"2017-05-12T17:09:10.000Z","comments":true,"path":"2017/05/11/hello-world/","link":"","permalink":"http://blog.xgo.pub/2017/05/11/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}